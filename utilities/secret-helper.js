export const part1 = "63,1,23,65,79,42,10,76,1,65,25";

export const midParts = [
  "35,0,0,78,79,25,0,0,15,73,5,28,1,76,9,69,16,67,0,2,2,22,7,13,73,26,8,0,94,79,31,27,6,17,72,28,78,4,71,6,12,87,38,85,27,11,85,8,11,0,15,11,15,17,26,73,6,6,86,3,79,27,25,9,2,73,1,11,1,0,29,72,18,79,20,8,18,69,10,27,85,19,11,10,84,28,1,15,19,0,4,0,6,28,72,10,70,79,27,22,0,30,79,2,3,17,76,3,79,68,27,72,19,1,12,19,0,73,26,8,71,3,27,26,17,26,69,65,1,10,69,72,6,87,87,2,0,15,12,0,11,26,82,65,2,16,2,13,26,78,16,79,19,3,22,84,11,13,65,1,9,0,0,0,78,87,27,29,9,68,80,22,0,67,4,29,10,90,72,38,24,2,82,70,27,26,17,72,22,85,2,3,0,82,73,87,18,79,23,9,7,65,9,10,0,7,28,16,17,6,13,29,75,0,21,31,23,26,12,12,78,8,78,4,0,5,79,3,79,26,10,68,84,13,2,69,65,4,12,7,28,73,6,6,78,1,6,28,19,72,10,85,27,78,4,78,13,0,0,14,1,15,12,73,10,8,0,0,78,17,1,15,12,78,6,77,9,26,28,0,72,10,70,79,38,12,84,4,65,25,79,3,5,0,69,11,28,14,65,55,22,1,72,25,28,8,66,7,13,30,13,72,1,73,11,0,66,84,73,69,1,10,27,76,22,69,5,3,73,27,11,89,0,0,8,26,71,89,9,26,0,84,11,10,77,31,15,11,89,73,87,22,28,85,24,12,69,68,0,78,13,23,89,0,0,0,0,0,0,14,10,30,4,1,11,71,79,3,0,0,14,69,3,79,1,4,22,79,17,8,72,65,26,17,17,72,10,28,18,83,14,6,28,19,72,9,79,1,11,9,73,7,69,4,28,85,24,12,65,16,79,105,65,11,23,16,29,27,11,3,0,2,26,0,29,6,2,0,2,23,69,84,0,77,18,79,20,24,68,77,29,79,79,21,6,28,6,72,5,15,5,0,78,10,4,17,6,69,84,7,1,16,71,1,0,14,0,0,76,12,65,0,79,73,21,78,20,1,11,1,78,16,79,20,28,23,84,9,17,0,27,6,0,0,29,73,26,10,85,21,11,85,68,28,84,8,2,21,84,0,12,2,23,69,2,79,31,17,72,2,69,27,78,17,72,27,79,2,8,29,76,16,72,5,27,12,65,11,15,17,6,73,25,15,69,8,79,11,27,29,69,68,6,10,11,7,29,0,31,14,3,9,68,84,11,70,14,65,43,15,17,26,16,26,15,73,8,8,82,3,13,66,86,10,78,1,79,7,69,87,27,26,11,1,84,12,10,82,65,6,24,7,72,11,11,2,78,70,14,82,69,88,69,15,79,95,85,0,12,88,7,10,7,5,1,78,7,10,12,65,8,11,27,5,73,4,18,83,18,79,6,21,4,14,73,1,9,69,79,27,0,31,14,27,11,13,78,3,79,79,20,26,89,0,7,73,9,2,84,18,6,28,19,72,9,79,28,26,69,73,7,0,3,7,16,76,7,73,16,22,0,7,1,11,84,0,6,27,21,83,72,79,55,2,13,11,0,5,27,22,84,73,71,18,27,1,5,10,71,68,14,0,2,6,24,26,11,12,78,19,79,70,7,23,24,24,69,89,0,27,69,87,0,84,31,79,6,3,9,69,16,7,73,15,9,89,21,27,73,2,14,84,18,3,23,84,9,69,112,0,25,0,82,57,79,30,1,1,76,20,82,11,13,76,4,3,89,22,26,0,0,0,83,70,2,23,84,2,10,89,67,78,0,86,12,78,87,27,29,3,17,71,12,79,105,65,3,24,13,72,7,1,19,0,21,7,29,3,72,12,84,65,78,44,0,10,65,25,72,1,76,1,86,1,1,0,3,11,30,29,6,73,26,8,0,15,2,19,19,1,11,69,79,6,10,87,73,68,30,9,19,9,22,69,10,27,0,12,23,89,24,1,15,11,71,87,9,26,30,16,72,7,69,79,25,12,84,1,79,2,27,85,21,11,85,74,79,121,14,27,94,6,13,73,15,71,83,14,6,28,29,6,2,0,13,11,4,77,73,79,17,79,25,5,3,72,16,79,73,15,78,20,13,72,5,7,1,69,74,79,19,24,31,4,89,28,78,4,66,5,69,87,27,26,76,7,72,1,10,82,65,3,28,84,29,25,78,13,85,21,27,82,22,17,69,66,10,7,11,71,73,84,31,10,7,9,74,0,61,0,85,70,24,28,84,10,12,11,9,0,18,7,23,6,13,69,70,0,28,69,77,12,0,0,6,1,4,11,85,16,79,78,4,11,29,29,6,14,78,19,79,70,13,23,84,9,22,75,10,10,69,65,7,68,87,10,3,9,10,0,19,7,69,15,78,48,84,0,8,24,2,0,4,10,23,26,72,16,78,14,12,9,69,73,84,24,79,20,31,15,0,76,11,85,4,78,13,27,72,4,23,71,78,7,27,7,6,13,69,79,9,78,14,69,12,80,30,1,18,76,9,89,68,31,82,14,12,21,17,5,26,78,23,82,15,25,19,0,13,69,65,1,10,69,66,6,84,3,3,16,8,68,85,20,70,14,65,58,17,21,6,2,29,71,70,9,29,82,17,30,0,82,22,26,13,73,7,71,87,27,29,13,16,0,29,0,85,70,24,28,84,12,6,0,2,0,0,0,0,84,5,0,0,14,0,1,0,15,79,5,79,23,9,13,78,3,79,65,65,8,11,29,13,7,10,71,73,8,79,31,13,72,17,73,2,11,22,0,6,70,87,1,16,9,0,14,68,61,69,2,11,23,0,4,16,78,46,0,18,7,27,26,3,69,87,10,73,19,69,73,66,18,12,26,1,1,0,7,3,79,18,11,11,84,9,7,10,71,83,15,1,17,17,72,28,79,26,73,19,69,73,76,18,27,85,1,1,0,6,10,67,14,3,28,84,9,73,30,6,82,18,79,29,18,72,28,79,26,28,69,76,0,70,18,79,60,75,18,69,68,24,65,15,26,28,16,72,29,1,71,68,9,79,5,28,9,17,0,38,78,6,65,7,0,3,0,85,28,22,79,16,10,67,21,78,0,27,29,73,15,9,68,70,2,19,31,13,69,89,0,27,69,70,12,69,27,79,23,9,16,84,1,29,14,65,39,23,84,14,8,13,19,12,70,14,82,4,9,23,84,79,1,3,0,4,69,87,5,0,31,16,0,19,14,78,21,29,89,0,7,73,6,18,71,70,22,29,1,72,4,78,11,78,11,69,31,69,5,79,25,9,16,0,29,0,85,65,9,22,88,72,11,27,19,0,7,1,29,0,0,0,82,79,25,4,78,29,83,87,27,26,76,3,73,18,10,0,24,1,12,84,28,1,11,71,83,22,14,17,17,72,28,79,26,78,11,69,12,68,87,14,27,8,68,66,1,79,84,9,11,11,17,72,30,6,2,78,70,22,29,1,72,11,69,10,10,69,77,12,14,87,32,3,9,22,65,8,3,0,12,23,89,18,13,12,2,14,78,1,28,82,21,10,10,85,27,78,28,79,28,0,22,29,16,76,9,73,28,10,68,65,12,12,0,72,29,6,6,84,65,28,82,4,26,10,66,14,12,9,89,73,74,2,28,1,76,6,69,7,14,85,18,11,89,13,7,28,73,21,69,70,28,7,23,0,69,65,79,27,11,73,24,85,18,79,20,2,0,0,7,0,77,17,2,28,12,72,25,11,21,83,9,1,94,84,4,12,75,10,78,11,79,73,79,25,10,85,37,67,86,1,79,69,23,11,11,84,5,12,26,71,66,3,9,29,6,13,75,0,36,7,23,65,69,0,14,0,0,75,22,69,68,0,78,4,78,22,18,72,29,6,2,0,8,6,17,17,27,17,12,79,29,8,65,27,84,18,28,1,64,68,75,13,1,68,4,29,13,84,24,12,1,23,76,3,79,59,84,3,11,79,24,78,4,78,13,0,24,1,16,76,11,70,68,2,89,65,12,28,7,28,73,8,21,73,3,1,22,7,70,69,121,0,27,66,82,12,0,4,0,24,9,11,78,1,79,84,9,15,13,84,33,73,2,8,86,3,79,19,26,12,69,67,7,11,23,73,26,72,87,14,27,8,68,83,11,2,69,14,0,28,84,31,1,1,71,68,3,28,23,6,30,0,83,79,15,9,76,73,84,31,10,85,0,11,86,1,79,65,15,10,89,28,9,25,30,14,78,3,28,1,84,28,13,65,27,78,6,79,4,69,4,79,1,4,1,73,22,79,87,0,23,87,84,33,73,26,15,73,8,4,82,13,7,16,7,29,11,69,84,1,69,87,0,27,0,29,0,20,10,82,18,1,23,84,1,7,78,10,89,70,3,27,18,13,69,84,7,15,17,0,32,0,0,0,0,0,0,0,8,10,71,8,26,16,25,9,29,11,11,89,70,11,0,27,24,69,69,25,11,23,89,29,72,30,1,18,76,16,72,5,27,0,40,73,20,84,12,6,7,9,71,70,27,29,84,0,0,76,31,78,18,72,12,78,87,22,26,25,68,78,1,10,68,65,7,13,79,72,16,1,18,7,20,10,82,0,0,0,0,0,0,9,89,73,79,25,10,85,24,12,65,16,79,105,65,25,22,1,4,13,78,3,79,70,14,28,13,28,13,73,1,9,69,65,7,68,87,10,3,9,22,89,16,7,73,15,9,89,18,7,27,78,79,78,9,79,31,21,28,17,69,29,78,13,79,30,0,19,6,19,10,13,67,17,3,84,65,1,11,84,28,27,7,17,73,7,3,82,0,0,0,0,27,15,22,75,64,14,87,59,26,76,22,69,20,14,89,65,23,22,1,72,15,1,21,0,7,3,30,84,17,10,85,79,6,4,86,12,0,19,0,27,9,68,105,68,24,65,15,26,89,0,7,73,10,8,0,3,25,23,6,17,17,72,6,0,2,0,0,78,87,2,12,76,20,79,19,10,82,65,26,22,84,0,12,2,23,0,7,1,22,84,27,16,80,31,1,23,84,73,89,24,26,89,76,10,79,68,2,65,21,26,28,6,72,1,1,16,0,4,6,21,84,7,23,0,28,3,4,76,5,14,87,60,28,2,7,69,22,10,76,24,66,89,61,72,1,1,23,69,70,27,26,21,28,69,89,0,27,69,87,0,76,27,79,20,0,19,65,29,28,0,3,11,89,29,6,73,3,30,0,10,6,20,17,68,69,65,1,10,69,105,73,73,25,79,12,3,17,82,23,65",
];

export const part3 =
  "89,33,11,68,10,28,21,82,12,69,3,79,88,76,46,65,10,65,0,89,66,89,70,88,91,94";

let minLength = Math.min(
  part1.length,
  ...midParts.map((p) => p.length),
  part3.length
);

const padKey = (key, length) => {
  while (key.length < length) {
    key += key;
  }
  return key.substring(0, length);
};

const decrypt = (secret, key) => {
  key = padKey(key, secret.length);

  let s = "";
  const splitted = secret.split(",");

  for (const [i, c] of splitted.entries()) {
    const xor = parseInt(c) ^ key.charCodeAt(i);
    s += String.fromCharCode(xor);
  }

  return s;
};

export const decode = (userInput, secret) => {
  let key = userInput.toLowerCase().trim();
  if (key.length === 0) {
    const range = 122 - 32 + 1;
    for (let i = 0; i < minLength * 5; i++) {
      key += String.fromCharCode(Math.ceil(Math.random() * range + 32));
    }
  }
  return decrypt(secret, key);
};

const encrypt = (secret, text) => {
  const key = padKey(secret, text.length);
  let s = [];

  for (let i = 0; i < text.length; i++) {
    s.push(key.charCodeAt(i) ^ text.charCodeAt(i));
  }

  return s.join(",");
};

export const encode = (userInput, plaintext) => {
  const secret = userInput.toLowerCase().trim();
  const text = plaintext.trim();
  if (secret.length === 0 || text.length === 0) {
    return plaintext;
  }
  return encrypt(secret, text);
};
